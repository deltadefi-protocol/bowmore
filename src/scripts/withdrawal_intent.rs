use whisky::{
    data::{byte_string, Address, Int},
    ConstrEnum,
};

#[derive(Debug, Clone, ConstrEnum)]
pub enum WithdrawalIntentDatum {
    Datum(Address, Int),
}

impl WithdrawalIntentDatum {
    pub fn new(amount: &str, address: &str) -> Self {
        let w_amount = Int::new(
            amount
                .parse::<i128>()
                .expect("Failed to parse amount as i128"),
        );
        let w_address = whisky::deserialize_address(address);

        let (payment_key_hash, is_script_payment_key) = if w_address.pub_key_hash.is_empty() {
            (w_address.script_hash, true)
        } else {
            (w_address.pub_key_hash, false)
        };

        let (stake_key_hash, is_script_stake_key) = if w_address.stake_key_hash.is_empty() {
            (w_address.stake_key_script_hash, true)
        } else {
            (w_address.stake_key_hash, false)
        };

        let address_datum = Address::new(
            &payment_key_hash,
            Some(&stake_key_hash),
            is_script_payment_key,
            is_script_stake_key,
        );

        WithdrawalIntentDatum::Datum(address_datum, w_amount)
    }
}
use whisky::{
    utils::blueprint::{MintingBlueprint, SpendingBlueprint},
    BuilderDataType, LanguageVersion,
};

use crate::{
    config::AppConfig,
    scripts::{lp_token::lp_token_mint_blueprint, plutus_loader::get_compiled_code_by_index},
};

pub fn withdrawal_intent_mint_blueprint(
    oracle_nft: &str,
) -> Result<MintingBlueprint, whisky::WError> {
    let lp_token_mint_blueprint = lp_token_mint_blueprint(oracle_nft)?;
    let mut blueprint = MintingBlueprint::new(LanguageVersion::V3);
    let compiled_code = "5924f10101002229800aba4aba2aba1aba0aab9faab9eaab9dab9cab9a9bae0039bae00248888888888a60022a660089214765787065637420536f6d6528707269636529203d20707269636573207c3e2070616972732e6765745f66697273742828706f6c6963795f69642c2061737365745f6e616d65292900168a998022495965787065637420696e7075745f646174756d3a205769746864726177616c496e74656e74446174756d203d0a2020202020202020202020202020202020202020696e7075745f696e6c696e655f646174756d28696e7075742900168a9980224963657870656374205b6f70657261746f725f6f75747075745d203d0a202020202020202020202020202020206f7574707574735f6174286f7574707574732c2066726f6d5f766572696669636174696f6e5f6b6579286f70657261746f725f6b6579292900168a9980224967657870656374207661756c745f6f7261636c655f6f75747075745f646174756d3a205661756c744f7261636c65446174756d203d0a202020202020202020206f75747075745f696e6c696e655f646174756d287661756c745f6f7261636c655f6f75747075742900168a9980224947657870656374205b7661756c745f6f7261636c655f6f75747075745d203d206f7574707574735f776974685f706f6c696379286f7574707574732c206f7261636c655f6e66742900168a9980224953657870656374204d657373616765207b207661756c745f62616c616e63652c207072696365732c207574786f5f726566207d3a204d657373616765203d0a202020202020202020207369676e65645f6461746100168a9980224964657870656374207661756c745f6f7261636c655f696e7075745f646174756d3a205661756c744f7261636c65446174756d203d0a20202020202020202020696e7075745f696e6c696e655f646174756d287661756c745f6f7261636c655f696e7075742900168a998022491872656465656d65723a20496e74656e7452656465656d6572001648888888966002646465300130103754003370e90014c05000e602800491112cc004c00c0122646644944c064004c064c068004c054dd5002c4c966002600200b13259800801c4c8cc8966002600a003159800980d1baa006801403501b4566002601000313259800800c03a264b3001001807c03e26644b3001001808c4c966002003012809404a0251332259800800c052264b300100180ac056264b30013027003899806003912cc00400a26601c00644b3001002807c4c96600200301b80dc06e0371323003302d004375c0028168c0a800902844c96600200301980cc066264600660560086eb40060328158c0a000902640590241bac00180ac0550271812000a044375c00260460048120c08400501f1bac0013020002807c03d021180f000a038301a375400d00d405c80b84cc88c8c8cc88ca6002604400314a13758604400f3758604400b3756604460466046008911112cc004c03cc08cdd5002c4c9660020030058acc004c0a4006264944c0a000600a81310261bac302730280068cc004c090dd5002c8c0a0c0a40066e3d221009b87480112222332298009bae302d0029bac302d302e002992cc004c010c0a8dd5000c4c0b8c0acdd5000c54cc0a52413265787065637420496e6c696e65446174756d287261775f646174756d29203d20696e7075742e6f75747075742e646174756d001640a0605a605c605c60546ea8c014c0a8dd5000cdd6181680324444b30010028994c00400e33001302f3754007370290004dc02400537009000a4444646464646464653001375c607a003375c607a607c607c607c003980091112cc004cdc400124061130010028acc004cdc380124061133004480088c0080062b300133710004901c44cc00ccdc7244103020408003370000490189180119bca4a2003124bded8c10140000101200040ec81d903b488888ca600200300380120022225980099b89002480022600297ae08919194c00401a602600b23005330480020019bad30450024018608600330010098044005007207e9b87483f80e4466ec0008dd4000cdc6808244444664464b3001302d0048a60103d87a80008992cc0066002605c6eb4c10c0069429450404530103d87a800089815198229821000a5eb810404c004006440032225980099b8900148002297bdb18010140000101200089980119b8e01b3370200e00266e0400400d04248896600266e2400520008a5ef6c601014000010120008998014c004cdc0803800c00e036b8c19b810010034109004400481f888cc004888c8c8cdd8191ba73304b30480013304b30490014bd7019bb030470023047001304800198008034880060090039bad30470014019300100591000c00e0050014014446600490011192cc004cdc4800a40091598009819000c6600200900380148c02cdd4000a01a8acc004c0d400633001004801ccdc00012407f2300b3750602c6030002806a2b30013370e004905f00c4c8cc0040048c030dd48009119803240044b3001300e00189801245008cc00401e00d33700002903fc8cc0100108c010cdc5001000a014411d19800802400e66e00009207f918059ba9001401c822104420888acc004cdc3800a401919800802400e66e0000920ff02919802a40044b30013370e004906600c492f7b63001014000010120008992cc004cdc38012417c0519800803c01a66012012440032300e3374a004002805a330010078034cdc0001241fe0329800804401e66014014440030019180799ba5003001404080810472cc004cdc4a41002800513370066e0000920ff134803a266e0000920f1014118823100d456600266e1c00520088acc004cdc38012417c0519800802400e6600c00c440032300b374e002804233001004801ccdc0001241fe0329800802c0126600e00e44003001918061ba700140348069044456600266e1c005200a8acc004cdc3801241fc0513232330010012300d374c002446600e900112cc004c03c0062600497adef6c608919194c00401a4600c660a2004003375a609c0048030c8cdd81828800982898290009bac304c0019800804c02260360028029048198030031100146600200900399b80002482fc0a464653001001801c8c038dd3000a0022225980099b89002480022600297adef6c608919194c00401a603a00b23005330520020019bad304f00240186466ec0c148004c148c14c004dd61826800cc00402a01300140148248cc01c01c8800900d20888925ef6c6101400001012000411082210442088337060029020111119198008008011119803240044b3001300a0018980125eb8224646530010069180319826001000cdd69824801200c30470019800804401e602c002803104311114c00401200700291980200091801800a0124dd7181e805cdd6181e803cdd6981e8034dd6981e802cdd6981e8024dd7181e801cdd6981e80124444444444b3001302f3043375401113259800800c566002606060886ea8006264b300100181dc4c96600200303c81e40f226644b300100181f44c96600200303f899912cc00400608313259800800c56600260a2005133036003225980080145660026074609c6ea800e264b3001001822c4c966002003046823411a08d1332259800800c122264b3001001824c12609313259800982c801c660026e0403a444b3001337120049000440063300100399b840024805266e2ccdc019b85002480512060001400c82aa4444646600200200a44b30010018802c4c966002003133004305f002006899802982f80119801801800a0ba305f001417122232330010010042259800800c4012264664466446600400400244b30010018801c4ca600200b375c60be003375a60c0003330030033064002402460c40028300dd5982e8019bae305a00133003003305f002305d001416d2232330010010032259800800c5300103d87a80008992cc004cdd79ba70043059001898209982e182d000a5eb8226600600660bc00482b8c17000505a4c8cc0040040e8896600200314bd7044cc8966002646600200264660020026eacc178c17cc16cdd5002112cc004006297ae0899199119198008009bab30600042259800800c400e264660c86e9ccc190dd4802998321830800998321831000a5eb80cc00c00cc198008c1900050621bae305c001330030033061002305f001417444b30010018a508acc004cdc79bae305e375860bc0020af14a3133002002305f001416082e22660b600466008008003133004004001415860b400260b600282c122222232323298009800800c888cdc3cc00400e900048888c96600260a260ca6ea8006266e00008cdc10019bad306930663754003060418c6601800a660ce6ea4010cc19cdd4801a5eb8100900156600266e2405c07a2900044cdc199b82300901e01d483200505b2444646644b300100a82d44c96600260d201713259800800c66002003133225330663372c92010a746f74616c5f6c703a20003732660146ea0cdc08148032450015330663372c92010e68776d5f6c705f76616c75653a20003732660146ea0cdc09809804002a450015330663372c92010c7661756c745f636f73743a20003732660146ea0cdc0812802a4500159800acc004cdc39919b813300132323300100104a2259800800c52f5bded8c1133225980099baf3071306e375460e260e460dc6ea800801626530010018014dd59839183998379baa30723073306f3754006800888966002005100189919914c00401a60f000b32330010010052259800800c4cc1e0cdd81ba9004374c00697adef6c608994c004dd7183b000cdd5983b800cc1ec0092225980099b9000800389983e19bb037520106e9801c0162b30013371e010007132598009833183d1baa00189983e99bb0375201260fc60f66ea800400a200483c0c966002b30010018a518a5041f114c103d87a8000898311983e9ba60014bd7020f0329800800c022006800888966002005100189919914c00401a61080200b32330010010052259800800c4cc21004cdd81ba9004375000697adef6c608994c004dd7184100800cdd6984180800cc21c040092225980099b900080038998440099bb037520106ea001c0162b30013371e0100071325980098391843009baa0018998448099bb03752012611402610e026ea800400a2004842008c96600260e400314c0103d87a80008983719844809ba80014bd702108023370000e00513308801337606ea400cdd400119803003000a10602420c04308501001420c048030dd7183e8009bad307e00130800100241f913307c337606ea400cdd300119803003000a0ee41dc307900141dc8030dd718388009bab3072001307400241c9100141ac60de0026600400460e00028368c1300bc07ccc004c8c8cc00400413c896600200314bd6f7b63044cc896600266ebcc1c4c1b8dd5001002c4ca60020030029bab30723073306f3754006800888966002005100189919914c00401a60f000b32330010010052259800800c4cc1e0cdd81ba9004374c00697adef6c608994c004dd7183b000cdd5983b800cc1ec0092225980099b9000800389983e19bb037520106e9801c0162b30013371e010007132598009833183d1baa00189983e99bb0375201260fc60f66ea800400a200483c0c966002b30010018a518a5041f114c103d87a8000898311983e9ba60014bd7020f0329800800c022006800888966002005100189919914c00401a61080200b32330010010052259800800c4cc21004cdd81ba9004375000697adef6c608994c004dd7184100800cdd6984180800cc21c040092225980099b900080038998440099bb037520106ea001c0162b30013371e0100071325980098391843009baa0018998448099bb03752012611402610e026ea800400a2004842008c96600260e400314c0103d87a80008983719844809ba80014bd702108023370000e00513308801337606ea400cdd400119803003000a10602420c04308501001420c048030dd7183e8009bad307e00130800100241f913307c337606ea400cdd300119803003000a0ee41dc307900141dc8030dd718388009bab3072001307400241c9100141ac60de0026600400460e00028368c1300bc07c8a600200548002444464b3001305a306e375400313370000466e0800cdd6983918379baa001834a0d833015005330703752008660e06ea400d2f5c0809001629462a660cc92011a7661756c745f756e6c6f636b5f636865636b203f2046616c73650014a0832a2b30015980099baf306b3068375407e03914a31533066491167574786f5f7265665f636865636b203f2046616c73650014a0832a2b300159800cc004c0e001a29426466002002646600200208e44b30010018a5eb82264664464660020026eacc1bc01089660020031003899198399ba733073375200a660e660e0002660e660e200297ae0330030033075002307300141c46eb8c1ac004cc00c00cc1c0008c1b800506c112cc004006297ae0899912cc004cdc79bae306f0020318998371ba700233004004001899802002000a0d2375860da00260dc002835922259800800c00a2b3001306f0018992cc004c118dd71837800c4cdc39bad306f30700010048a5041a460de6eb0c1b8006004836106c229462a660cc9201156c705f6d696e745f636865636b203f2046616c73650014a0832a2b300159800cc004c0e0c8cc0040040f08966002003148002260726600400460dc002835a29426466002002646600200208e44b30010018a5eb82264664464660020026eacc1bc01089660020031003899198399ba733073375200a660e660e0002660e660e200297ae0330030033075002307300141c46eb8c1ac004cc00c00cc1c0008c1b800506c112cc004006297ae0899912cc004cdc79bae306f0020568998371ba700233004004001899802002000a0d2375860da00260dc002835922259800800c00a2b3001306f0018992cc004c118dd71837800c4cdc39bad306f30700010048a5041a460de6eb0c1b8006004836106c229462a660cc920119696e74656e745f6275726e5f636865636b203f2046616c73650014a0832a2b300159800800c528c54cc1992401277661756c745f6f7261636c655f6f75747075745f646174756d5f636865636b203f2046616c73650014a0832a2b3001598008014528c54cc19924012a69735f7661756c745f6f7261636c655f6f75747075745f76616c75655f636c65616e203f2046616c73650014a0832a2b30015980099b8848000022264b3001001830c4c96600260dc005198009bab3045306a375400300a810201683120d6306c00141a864646600200209c44b30010018a5eb8226644b30013375e60e060da6ea80080162660de0046600800800313300400400141a860dc00260de0028360c13ccc1a8c13ccc1a8dd481325eb80cc1a9300103d87a80004bd704528a0ca8a518a9983324811d6f70657261746f725f6f75747075745f636865636b203f2046616c73650014a0832a2941065452820ca8a50419514a0832a2941065452820ca303f3259800800c52000899181b992cc00400a2900044c0e0cc004004c1b400906a112cc0040062900044c0e4cc008008c1b800506b1835800a0d032330010013756608460ce6ea800c896600200314bd7044c8cc88c8cc004004dd59836002112cc004006200713233070374e660e06ea4014cc1c0c1b4004cc1c0c1b80052f5c06600600660e400460e00028370dd718340009980180198368011835800a0d23375e002646464646460a4660da60dc00a660da60dc008660da60dc006660da6ea0cdc0816004998369ba833702602c016010660da60dc004660da60dc002660da6ea0cdc08140041837983780098370009836983698368009836000983580098331baa03a82ea07082ec1760bb05d41ac64b3001303f306537540031306930663754003153306449012c65787065637420496e6c696e65446174756d287261775f646174756d29203d206f75747075742e646174756d0016418c60d060d260d260ca6ea80060b68330c19c0290651bad3065001375a60ca60cc00264664465300100182240e2900052000400444444b30010048acc00400e2660d66ea0008cc1acdd4000a5eb822a660ce921314261746368207769746864726177616c20696e74656e74205554784f73206e6f742066756c6c792070726f636573736564001641a913322332259800982d98361baa0018acc004cdc79bae3070306d37540020af159800803c54cc1ad241234d6f7265205554784f7320617265207370656e74207468616e20737065636966696564001689919912cc004c16cc1bcdd500144cc896600200313259800982f18391baa0028992cc0040060db13259800800c4c96600200306f8992cc0040060e107083844c96600260f80071598009831983b9baa0048992cc0040060e513259800800c4c9660020030748992cc0040062b30013080010028cc00400e264b300130680018992cc0040060ef13259800800c566002610602005132598009835800c4c96600200307a8992cc0040062b30013086010028cc00400602107b407d07b420c0507b83dc1ee0f6843808c21004005082011840009baa0028acc004c1b8006264b300100183d44c96600200307b83dc1ee26644b300100183ec4c96600200307e83f41fa26644b300100184000c4c9660020030810184080c20406264b3001308d0100380bc2080508a011bad00184080a11a02308a010014220046eb4004c2240400a0fc845008c21c04005085011bad00130860100283da10e023084010014208046100026ea800a0f283e907d183f1baa00183c21000283c41e20f107842100461020200283f8c1f4dd5001456600260d6003159800983e9baa002805c1d907e41d907a20f4307b3754003075406507541f507583ac1d60ea840808c1f800507c183f00141ce0e7073839a0fe307c00141e860f06ea80120e283aa0e283c8dd6800c1c107c183c800a0ee307900283741ba0dd06e41e860ee00283a8c1ccdd500141b107009919194c004cdc0006800cc1e000e66e000380092225330763372c92121746f74616c5f696e74656e745f646174756d5f6c705f7573645f76616c75653a20003732660346ea000d220100159800acc00660026eacc14cc1e0dd5004401205c80ca266ebcc1ecc1e0dd5004001452820ea8cc004026003003403515330764901225769746864726177616c20696e74656e74206f757470757420696e636f7272656374001641d43370666e08004c07c0500d4dd6983b183b80098391baa001835c1ae0d706b41dc60e660e06ea8008c966002609460e06ea8006260e860e26ea80062a660de9213265787065637420496e6c696e65446174756d287261775f646174756d29203d20696e7075742e6f75747075742e646174756d001641b860e660e860e860e06ea8c1ccc1d0c1c0dd5003c54cc1b924013865787065637420536f6d65286f75745f7574786f29203d206f757470757473207c3e206c6973742e6174286f75747075745f696e64657829001641b4660180a400260e40106eb4c1c001d06e46600200f006802a00441a919800803c01a00a801106a1114c00402a009003801400500a183718359baa306e306b3754608c60d66ea8008c1b0010c1b401106a1800800911192cc004c144006264b3001001801c4c9660020030048024012009132598009836801c01a00a8350dd7000a0da306a00141a060cc6ea80122b300130540018992cc00400600713259800800c01200900480244c96600260da007006802a0d4375c0028368c1a800506818331baa00480120c6418c60c86ea800c8896600200514c0103d87a80008acc004c13c00626096660cc60ce00497ae08cc00400e60d00053032001400c83090650888c9660020071323233223300900233714910101280059800800c4cdc52441035b5d2900006899b8a489035b5f20009800800ccdc52441025d2900006914c00402a00530070014029229800805400a002805100e20cc5980099b880014803a266e0120f2010018acc004cdc4000a41000513370066e01208014001480362c83010601bac3063002375a60c20026466ec0dd418308009ba73062001375400713259800800c4cdc52441027b7d00003899b8a489037b5f20003232330010010032259800800c400e264b30010018994c00402a60cc003337149101023a200098008054c19c00600a805100a183480144ca6002015306600199b8a489023a200098008054c19c006600e66008008004805100a183480120ce3069001419866e29220102207d00003418c6eac00e264b3001001899b8a489025b5d00003899b8a489035b5f20009800800ccdc52441015d00003914c00401e0053004001401d229800803c00a002803900b20c63758007133005375a0060051323371491102682700329800800cc0c4dc68014cdc52450127000044004444b30013371000490004400626466453001006981b002ccdc599b800025980099b88002480522903045206e419466e2ccdc0000acc004cdc4000a40291481822903720ca004401866e0c00520203370c002901019b8e00400241886eb800d0661b8a4881022c200022323300100100322598009825800c4cdc52450130000038acc004cdc4000a40011337149101012d0033002002303000189980299b8400148050cdc599b803370a002900a240c000682e905d1802802a09482b0dd6800c125059182b000a0a8375c00260aa00482b0c14c00505118279baa0038222098899192cc00400608d046899912cc00400609104882444c9660020070498992cc00400609504a825412a26644b300100182644c96600200304d826c13609b13259800982e801c4c02cc17403209c82d0dd7000a0ba305a00141606eb8004c16401105a182b801a0aa375a00304841606eb0004c14400a08d0464158609e00260a40048282084827208504282141090521827800a09a3756002609c00503f81fc0fd04f1826000a094375a002609600503c413060920028238c114dd5000c0e904240ea07503a81d209430473044375401115330424913465787065637420536f6d65287369676e65645f6461746129203d2063626f722e646573657269616c697365286d6573736167652900164104303d001303c001303b001303a0013039001303800130373037004408d0011112cc004c070c0c0dd5001c4c9660020030028992cc004006007003801c00e26644b3001001802c4c966002003006803401a00d1332259800800c022264b3001001804c02626644b3001001805c4c96600200300c806403226644b300100180744c96600200300f807c03e26644b3001001808c4c966002003012809404a26644b300100180a44c96600200301580ac05602b1332259800800c05e264b300100180c40620311332259800800c06a264b300100180dc06e03701b899912cc00400603b13259800800c07a03d01e80f44cc89660020030208992cc004006043021810c08626644b3001001811c4c966002003024812409204913259800982c801c4cc0f807089660020050288992cc00400605102881440a2264600660ba0086eb800505d182d00120b0812a0ac375c00282c8c1580050541bae0013055002415860a60028288dd7000982900120a6305000141386eb8004c13c0090501826800a096375a0026098005018413460940028240dd700098248012094304700141146eb4004c11800a0248238c1100050421bad0013043002807a088304100140fc6eb4004c10000a0188208c0f800503c1bac001303d002804c02503e181d800a072375c002607400481d8c0e00050361bae001303700240e0606a0028198c0c4dd5001c00502e408a04502281120661816002192cc004c050c0a0dd5000c4c0b0c0a4dd5000c54cc09d241b765787065637420536f6d65286f7261636c655f696e70757429203d0a20202020696e707574730a2020202020207c3e206c6973742e66696e64280a20202020202020202020666e287265665f696e7075743a20496e70757429207b0a2020202020202020202020207175616e746974795f6f66287265665f696e7075742e6f75747075742e76616c75652c206f7261636c655f6e66742c20222229203d3d20310a202020202020202020207d2c0a20202020202020202900164098646600200201044b30010018a60103d87a80008992cc004c064c966002603460566ea80062900044dd6981798161baa00140a464b3001301a302b375400314c103d87a8000899198008009bab3030302d375400444b30010018a6103d87a8000899192cc004cdc8a45000018acc004c0280062602e66064606000497ae08a60103d87a800040b5133004004303400340b46eb8c0b8004c0c400502f205232330010013756600e60586ea8c01cc0b0dd5001112cc004006298103d87a8000899192cc004cdc8815800c56600266e3c0ac0062602c66062605e00497ae08a60103d87a800040b1133004004303300340b06eb8c0b4004c0c000502e44c048cc0b40052f5c1133003003302f00240a0605a0028158810866040014660406e9cc8c8cc004004010896600200314bd7044cc8966002b30013375e604c60466ea80080162646600200264660020026eacc0a0c0a4c094dd5002112cc004006297ae0899199119198008009bab302a0042259800800c400e2646605c6e9ccc0b8dd4802998171815800998171816000a5eb80cc00c00cc0c0008c0b800502c1bae302600133003003302b0023029001409c44b30010018a508acc004cdc79bae30283758605000201f14a3133002002302900140888132294102044cc094008cc0100100062660080080028100c090004c094005022180080425eb80dd6180f800918021980f99ba548008cc07cdd4800a5eb80cc07d30103d87a80004bd70180f800980f001180c1baa005374a9000180b9baa00422323300100100322330030013002002805402a01500a40706eb8c064c058dd50034590131b87480010120c04cc050004c04c004c038dd500a45268a9980624811856616c696461746f722072657475726e65642066616c73650013656402c1"; // Using index 0 for deposit intent spend
    blueprint
        .param_script(
            &compiled_code,
            &[
                &byte_string(oracle_nft).to_string(),
                &byte_string(&lp_token_mint_blueprint.hash).to_string(),
            ],
            BuilderDataType::JSON,
        )
        .unwrap();
    Ok(blueprint)
}

pub fn withdrawal_intent_spend_blueprint(
    oracle_nft: &str,
) -> Result<SpendingBlueprint, whisky::WError> {
    let AppConfig { network_id, .. } = AppConfig::new();
    let lp_token_mint_blueprint = lp_token_mint_blueprint(oracle_nft)?;

    let mut blueprint =
        SpendingBlueprint::new(LanguageVersion::V3, network_id.parse().unwrap(), None);
    let compiled_code = "5924f10101002229800aba4aba2aba1aba0aab9faab9eaab9dab9cab9a9bae0039bae00248888888888a60022a660089214765787065637420536f6d6528707269636529203d20707269636573207c3e2070616972732e6765745f66697273742828706f6c6963795f69642c2061737365745f6e616d65292900168a998022495965787065637420696e7075745f646174756d3a205769746864726177616c496e74656e74446174756d203d0a2020202020202020202020202020202020202020696e7075745f696e6c696e655f646174756d28696e7075742900168a9980224963657870656374205b6f70657261746f725f6f75747075745d203d0a202020202020202020202020202020206f7574707574735f6174286f7574707574732c2066726f6d5f766572696669636174696f6e5f6b6579286f70657261746f725f6b6579292900168a9980224967657870656374207661756c745f6f7261636c655f6f75747075745f646174756d3a205661756c744f7261636c65446174756d203d0a202020202020202020206f75747075745f696e6c696e655f646174756d287661756c745f6f7261636c655f6f75747075742900168a9980224947657870656374205b7661756c745f6f7261636c655f6f75747075745d203d206f7574707574735f776974685f706f6c696379286f7574707574732c206f7261636c655f6e66742900168a9980224953657870656374204d657373616765207b207661756c745f62616c616e63652c207072696365732c207574786f5f726566207d3a204d657373616765203d0a202020202020202020207369676e65645f6461746100168a9980224964657870656374207661756c745f6f7261636c655f696e7075745f646174756d3a205661756c744f7261636c65446174756d203d0a20202020202020202020696e7075745f696e6c696e655f646174756d287661756c745f6f7261636c655f696e7075742900168a998022491872656465656d65723a20496e74656e7452656465656d6572001648888888966002646465300130103754003370e90014c05000e602800491112cc004c00c0122646644944c064004c064c068004c054dd5002c4c966002600200b13259800801c4c8cc8966002600a003159800980d1baa006801403501b4566002601000313259800800c03a264b3001001807c03e26644b3001001808c4c966002003012809404a0251332259800800c052264b300100180ac056264b30013027003899806003912cc00400a26601c00644b3001002807c4c96600200301b80dc06e0371323003302d004375c0028168c0a800902844c96600200301980cc066264600660560086eb40060328158c0a000902640590241bac00180ac0550271812000a044375c00260460048120c08400501f1bac0013020002807c03d021180f000a038301a375400d00d405c80b84cc88c8c8cc88ca6002604400314a13758604400f3758604400b3756604460466046008911112cc004c03cc08cdd5002c4c9660020030058acc004c0a4006264944c0a000600a81310261bac302730280068cc004c090dd5002c8c0a0c0a40066e3d221009b87480112222332298009bae302d0029bac302d302e002992cc004c010c0a8dd5000c4c0b8c0acdd5000c54cc0a52413265787065637420496e6c696e65446174756d287261775f646174756d29203d20696e7075742e6f75747075742e646174756d001640a0605a605c605c60546ea8c014c0a8dd5000cdd6181680324444b30010028994c00400e33001302f3754007370290004dc02400537009000a4444646464646464653001375c607a003375c607a607c607c607c003980091112cc004cdc400124061130010028acc004cdc380124061133004480088c0080062b300133710004901c44cc00ccdc7244103020408003370000490189180119bca4a2003124bded8c10140000101200040ec81d903b488888ca600200300380120022225980099b89002480022600297ae08919194c00401a602600b23005330480020019bad30450024018608600330010098044005007207e9b87483f80e4466ec0008dd4000cdc6808244444664464b3001302d0048a60103d87a80008992cc0066002605c6eb4c10c0069429450404530103d87a800089815198229821000a5eb810404c004006440032225980099b8900148002297bdb18010140000101200089980119b8e01b3370200e00266e0400400d04248896600266e2400520008a5ef6c601014000010120008998014c004cdc0803800c00e036b8c19b810010034109004400481f888cc004888c8c8cdd8191ba73304b30480013304b30490014bd7019bb030470023047001304800198008034880060090039bad30470014019300100591000c00e0050014014446600490011192cc004cdc4800a40091598009819000c6600200900380148c02cdd4000a01a8acc004c0d400633001004801ccdc00012407f2300b3750602c6030002806a2b30013370e004905f00c4c8cc0040048c030dd48009119803240044b3001300e00189801245008cc00401e00d33700002903fc8cc0100108c010cdc5001000a014411d19800802400e66e00009207f918059ba9001401c822104420888acc004cdc3800a401919800802400e66e0000920ff02919802a40044b30013370e004906600c492f7b63001014000010120008992cc004cdc38012417c0519800803c01a66012012440032300e3374a004002805a330010078034cdc0001241fe0329800804401e66014014440030019180799ba5003001404080810472cc004cdc4a41002800513370066e0000920ff134803a266e0000920f1014118823100d456600266e1c00520088acc004cdc38012417c0519800802400e6600c00c440032300b374e002804233001004801ccdc0001241fe0329800802c0126600e00e44003001918061ba700140348069044456600266e1c005200a8acc004cdc3801241fc0513232330010012300d374c002446600e900112cc004c03c0062600497adef6c608919194c00401a4600c660a2004003375a609c0048030c8cdd81828800982898290009bac304c0019800804c02260360028029048198030031100146600200900399b80002482fc0a464653001001801c8c038dd3000a0022225980099b89002480022600297adef6c608919194c00401a603a00b23005330520020019bad304f00240186466ec0c148004c148c14c004dd61826800cc00402a01300140148248cc01c01c8800900d20888925ef6c6101400001012000411082210442088337060029020111119198008008011119803240044b3001300a0018980125eb8224646530010069180319826001000cdd69824801200c30470019800804401e602c002803104311114c00401200700291980200091801800a0124dd7181e805cdd6181e803cdd6981e8034dd6981e802cdd6981e8024dd7181e801cdd6981e80124444444444b3001302f3043375401113259800800c566002606060886ea8006264b300100181dc4c96600200303c81e40f226644b300100181f44c96600200303f899912cc00400608313259800800c56600260a2005133036003225980080145660026074609c6ea800e264b3001001822c4c966002003046823411a08d1332259800800c122264b3001001824c12609313259800982c801c660026e0403a444b3001337120049000440063300100399b840024805266e2ccdc019b85002480512060001400c82aa4444646600200200a44b30010018802c4c966002003133004305f002006899802982f80119801801800a0ba305f001417122232330010010042259800800c4012264664466446600400400244b30010018801c4ca600200b375c60be003375a60c0003330030033064002402460c40028300dd5982e8019bae305a00133003003305f002305d001416d2232330010010032259800800c5300103d87a80008992cc004cdd79ba70043059001898209982e182d000a5eb8226600600660bc00482b8c17000505a4c8cc0040040e8896600200314bd7044cc8966002646600200264660020026eacc178c17cc16cdd5002112cc004006297ae0899199119198008009bab30600042259800800c400e264660c86e9ccc190dd4802998321830800998321831000a5eb80cc00c00cc198008c1900050621bae305c001330030033061002305f001417444b30010018a508acc004cdc79bae305e375860bc0020af14a3133002002305f001416082e22660b600466008008003133004004001415860b400260b600282c122222232323298009800800c888cdc3cc00400e900048888c96600260a260ca6ea8006266e00008cdc10019bad306930663754003060418c6601800a660ce6ea4010cc19cdd4801a5eb8100900156600266e2405c07a2900044cdc199b82300901e01d483200505b2444646644b300100a82d44c96600260d201713259800800c66002003133225330663372c92010a746f74616c5f6c703a20003732660146ea0cdc08148032450015330663372c92010e68776d5f6c705f76616c75653a20003732660146ea0cdc09809804002a450015330663372c92010c7661756c745f636f73743a20003732660146ea0cdc0812802a4500159800acc004cdc39919b813300132323300100104a2259800800c52f5bded8c1133225980099baf3071306e375460e260e460dc6ea800801626530010018014dd59839183998379baa30723073306f3754006800888966002005100189919914c00401a60f000b32330010010052259800800c4cc1e0cdd81ba9004374c00697adef6c608994c004dd7183b000cdd5983b800cc1ec0092225980099b9000800389983e19bb037520106e9801c0162b30013371e010007132598009833183d1baa00189983e99bb0375201260fc60f66ea800400a200483c0c966002b30010018a518a5041f114c103d87a8000898311983e9ba60014bd7020f0329800800c022006800888966002005100189919914c00401a61080200b32330010010052259800800c4cc21004cdd81ba9004375000697adef6c608994c004dd7184100800cdd6984180800cc21c040092225980099b900080038998440099bb037520106ea001c0162b30013371e0100071325980098391843009baa0018998448099bb03752012611402610e026ea800400a2004842008c96600260e400314c0103d87a80008983719844809ba80014bd702108023370000e00513308801337606ea400cdd400119803003000a10602420c04308501001420c048030dd7183e8009bad307e00130800100241f913307c337606ea400cdd300119803003000a0ee41dc307900141dc8030dd718388009bab3072001307400241c9100141ac60de0026600400460e00028368c1300bc07ccc004c8c8cc00400413c896600200314bd6f7b63044cc896600266ebcc1c4c1b8dd5001002c4ca60020030029bab30723073306f3754006800888966002005100189919914c00401a60f000b32330010010052259800800c4cc1e0cdd81ba9004374c00697adef6c608994c004dd7183b000cdd5983b800cc1ec0092225980099b9000800389983e19bb037520106e9801c0162b30013371e010007132598009833183d1baa00189983e99bb0375201260fc60f66ea800400a200483c0c966002b30010018a518a5041f114c103d87a8000898311983e9ba60014bd7020f0329800800c022006800888966002005100189919914c00401a61080200b32330010010052259800800c4cc21004cdd81ba9004375000697adef6c608994c004dd7184100800cdd6984180800cc21c040092225980099b900080038998440099bb037520106ea001c0162b30013371e0100071325980098391843009baa0018998448099bb03752012611402610e026ea800400a2004842008c96600260e400314c0103d87a80008983719844809ba80014bd702108023370000e00513308801337606ea400cdd400119803003000a10602420c04308501001420c048030dd7183e8009bad307e00130800100241f913307c337606ea400cdd300119803003000a0ee41dc307900141dc8030dd718388009bab3072001307400241c9100141ac60de0026600400460e00028368c1300bc07c8a600200548002444464b3001305a306e375400313370000466e0800cdd6983918379baa001834a0d833015005330703752008660e06ea400d2f5c0809001629462a660cc92011a7661756c745f756e6c6f636b5f636865636b203f2046616c73650014a0832a2b30015980099baf306b3068375407e03914a31533066491167574786f5f7265665f636865636b203f2046616c73650014a0832a2b300159800cc004c0e001a29426466002002646600200208e44b30010018a5eb82264664464660020026eacc1bc01089660020031003899198399ba733073375200a660e660e0002660e660e200297ae0330030033075002307300141c46eb8c1ac004cc00c00cc1c0008c1b800506c112cc004006297ae0899912cc004cdc79bae306f0020318998371ba700233004004001899802002000a0d2375860da00260dc002835922259800800c00a2b3001306f0018992cc004c118dd71837800c4cdc39bad306f30700010048a5041a460de6eb0c1b8006004836106c229462a660cc9201156c705f6d696e745f636865636b203f2046616c73650014a0832a2b300159800cc004c0e0c8cc0040040f08966002003148002260726600400460dc002835a29426466002002646600200208e44b30010018a5eb82264664464660020026eacc1bc01089660020031003899198399ba733073375200a660e660e0002660e660e200297ae0330030033075002307300141c46eb8c1ac004cc00c00cc1c0008c1b800506c112cc004006297ae0899912cc004cdc79bae306f0020568998371ba700233004004001899802002000a0d2375860da00260dc002835922259800800c00a2b3001306f0018992cc004c118dd71837800c4cdc39bad306f30700010048a5041a460de6eb0c1b8006004836106c229462a660cc920119696e74656e745f6275726e5f636865636b203f2046616c73650014a0832a2b300159800800c528c54cc1992401277661756c745f6f7261636c655f6f75747075745f646174756d5f636865636b203f2046616c73650014a0832a2b3001598008014528c54cc19924012a69735f7661756c745f6f7261636c655f6f75747075745f76616c75655f636c65616e203f2046616c73650014a0832a2b30015980099b8848000022264b3001001830c4c96600260dc005198009bab3045306a375400300a810201683120d6306c00141a864646600200209c44b30010018a5eb8226644b30013375e60e060da6ea80080162660de0046600800800313300400400141a860dc00260de0028360c13ccc1a8c13ccc1a8dd481325eb80cc1a9300103d87a80004bd704528a0ca8a518a9983324811d6f70657261746f725f6f75747075745f636865636b203f2046616c73650014a0832a2941065452820ca8a50419514a0832a2941065452820ca303f3259800800c52000899181b992cc00400a2900044c0e0cc004004c1b400906a112cc0040062900044c0e4cc008008c1b800506b1835800a0d032330010013756608460ce6ea800c896600200314bd7044c8cc88c8cc004004dd59836002112cc004006200713233070374e660e06ea4014cc1c0c1b4004cc1c0c1b80052f5c06600600660e400460e00028370dd718340009980180198368011835800a0d23375e002646464646460a4660da60dc00a660da60dc008660da60dc006660da6ea0cdc0816004998369ba833702602c016010660da60dc004660da60dc002660da6ea0cdc08140041837983780098370009836983698368009836000983580098331baa03a82ea07082ec1760bb05d41ac64b3001303f306537540031306930663754003153306449012c65787065637420496e6c696e65446174756d287261775f646174756d29203d206f75747075742e646174756d0016418c60d060d260d260ca6ea80060b68330c19c0290651bad3065001375a60ca60cc00264664465300100182240e2900052000400444444b30010048acc00400e2660d66ea0008cc1acdd4000a5eb822a660ce921314261746368207769746864726177616c20696e74656e74205554784f73206e6f742066756c6c792070726f636573736564001641a913322332259800982d98361baa0018acc004cdc79bae3070306d37540020af159800803c54cc1ad241234d6f7265205554784f7320617265207370656e74207468616e20737065636966696564001689919912cc004c16cc1bcdd500144cc896600200313259800982f18391baa0028992cc0040060db13259800800c4c96600200306f8992cc0040060e107083844c96600260f80071598009831983b9baa0048992cc0040060e513259800800c4c9660020030748992cc0040062b30013080010028cc00400e264b300130680018992cc0040060ef13259800800c566002610602005132598009835800c4c96600200307a8992cc0040062b30013086010028cc00400602107b407d07b420c0507b83dc1ee0f6843808c21004005082011840009baa0028acc004c1b8006264b300100183d44c96600200307b83dc1ee26644b300100183ec4c96600200307e83f41fa26644b300100184000c4c9660020030810184080c20406264b3001308d0100380bc2080508a011bad00184080a11a02308a010014220046eb4004c2240400a0fc845008c21c04005085011bad00130860100283da10e023084010014208046100026ea800a0f283e907d183f1baa00183c21000283c41e20f107842100461020200283f8c1f4dd5001456600260d6003159800983e9baa002805c1d907e41d907a20f4307b3754003075406507541f507583ac1d60ea840808c1f800507c183f00141ce0e7073839a0fe307c00141e860f06ea80120e283aa0e283c8dd6800c1c107c183c800a0ee307900283741ba0dd06e41e860ee00283a8c1ccdd500141b107009919194c004cdc0006800cc1e000e66e000380092225330763372c92121746f74616c5f696e74656e745f646174756d5f6c705f7573645f76616c75653a20003732660346ea000d220100159800acc00660026eacc14cc1e0dd5004401205c80ca266ebcc1ecc1e0dd5004001452820ea8cc004026003003403515330764901225769746864726177616c20696e74656e74206f757470757420696e636f7272656374001641d43370666e08004c07c0500d4dd6983b183b80098391baa001835c1ae0d706b41dc60e660e06ea8008c966002609460e06ea8006260e860e26ea80062a660de9213265787065637420496e6c696e65446174756d287261775f646174756d29203d20696e7075742e6f75747075742e646174756d001641b860e660e860e860e06ea8c1ccc1d0c1c0dd5003c54cc1b924013865787065637420536f6d65286f75745f7574786f29203d206f757470757473207c3e206c6973742e6174286f75747075745f696e64657829001641b4660180a400260e40106eb4c1c001d06e46600200f006802a00441a919800803c01a00a801106a1114c00402a009003801400500a183718359baa306e306b3754608c60d66ea8008c1b0010c1b401106a1800800911192cc004c144006264b3001001801c4c9660020030048024012009132598009836801c01a00a8350dd7000a0da306a00141a060cc6ea80122b300130540018992cc00400600713259800800c01200900480244c96600260da007006802a0d4375c0028368c1a800506818331baa00480120c6418c60c86ea800c8896600200514c0103d87a80008acc004c13c00626096660cc60ce00497ae08cc00400e60d00053032001400c83090650888c9660020071323233223300900233714910101280059800800c4cdc52441035b5d2900006899b8a489035b5f20009800800ccdc52441025d2900006914c00402a00530070014029229800805400a002805100e20cc5980099b880014803a266e0120f2010018acc004cdc4000a41000513370066e01208014001480362c83010601bac3063002375a60c20026466ec0dd418308009ba73062001375400713259800800c4cdc52441027b7d00003899b8a489037b5f20003232330010010032259800800c400e264b30010018994c00402a60cc003337149101023a200098008054c19c00600a805100a183480144ca6002015306600199b8a489023a200098008054c19c006600e66008008004805100a183480120ce3069001419866e29220102207d00003418c6eac00e264b3001001899b8a489025b5d00003899b8a489035b5f20009800800ccdc52441015d00003914c00401e0053004001401d229800803c00a002803900b20c63758007133005375a0060051323371491102682700329800800cc0c4dc68014cdc52450127000044004444b30013371000490004400626466453001006981b002ccdc599b800025980099b88002480522903045206e419466e2ccdc0000acc004cdc4000a40291481822903720ca004401866e0c00520203370c002901019b8e00400241886eb800d0661b8a4881022c200022323300100100322598009825800c4cdc52450130000038acc004cdc4000a40011337149101012d0033002002303000189980299b8400148050cdc599b803370a002900a240c000682e905d1802802a09482b0dd6800c125059182b000a0a8375c00260aa00482b0c14c00505118279baa0038222098899192cc00400608d046899912cc00400609104882444c9660020070498992cc00400609504a825412a26644b300100182644c96600200304d826c13609b13259800982e801c4c02cc17403209c82d0dd7000a0ba305a00141606eb8004c16401105a182b801a0aa375a00304841606eb0004c14400a08d0464158609e00260a40048282084827208504282141090521827800a09a3756002609c00503f81fc0fd04f1826000a094375a002609600503c413060920028238c114dd5000c0e904240ea07503a81d209430473044375401115330424913465787065637420536f6d65287369676e65645f6461746129203d2063626f722e646573657269616c697365286d6573736167652900164104303d001303c001303b001303a0013039001303800130373037004408d0011112cc004c070c0c0dd5001c4c9660020030028992cc004006007003801c00e26644b3001001802c4c966002003006803401a00d1332259800800c022264b3001001804c02626644b3001001805c4c96600200300c806403226644b300100180744c96600200300f807c03e26644b3001001808c4c966002003012809404a26644b300100180a44c96600200301580ac05602b1332259800800c05e264b300100180c40620311332259800800c06a264b300100180dc06e03701b899912cc00400603b13259800800c07a03d01e80f44cc89660020030208992cc004006043021810c08626644b3001001811c4c966002003024812409204913259800982c801c4cc0f807089660020050288992cc00400605102881440a2264600660ba0086eb800505d182d00120b0812a0ac375c00282c8c1580050541bae0013055002415860a60028288dd7000982900120a6305000141386eb8004c13c0090501826800a096375a0026098005018413460940028240dd700098248012094304700141146eb4004c11800a0248238c1100050421bad0013043002807a088304100140fc6eb4004c10000a0188208c0f800503c1bac001303d002804c02503e181d800a072375c002607400481d8c0e00050361bae001303700240e0606a0028198c0c4dd5001c00502e408a04502281120661816002192cc004c050c0a0dd5000c4c0b0c0a4dd5000c54cc09d241b765787065637420536f6d65286f7261636c655f696e70757429203d0a20202020696e707574730a2020202020207c3e206c6973742e66696e64280a20202020202020202020666e287265665f696e7075743a20496e70757429207b0a2020202020202020202020207175616e746974795f6f66287265665f696e7075742e6f75747075742e76616c75652c206f7261636c655f6e66742c20222229203d3d20310a202020202020202020207d2c0a20202020202020202900164098646600200201044b30010018a60103d87a80008992cc004c064c966002603460566ea80062900044dd6981798161baa00140a464b3001301a302b375400314c103d87a8000899198008009bab3030302d375400444b30010018a6103d87a8000899192cc004cdc8a45000018acc004c0280062602e66064606000497ae08a60103d87a800040b5133004004303400340b46eb8c0b8004c0c400502f205232330010013756600e60586ea8c01cc0b0dd5001112cc004006298103d87a8000899192cc004cdc8815800c56600266e3c0ac0062602c66062605e00497ae08a60103d87a800040b1133004004303300340b06eb8c0b4004c0c000502e44c048cc0b40052f5c1133003003302f00240a0605a0028158810866040014660406e9cc8c8cc004004010896600200314bd7044cc8966002b30013375e604c60466ea80080162646600200264660020026eacc0a0c0a4c094dd5002112cc004006297ae0899199119198008009bab302a0042259800800c400e2646605c6e9ccc0b8dd4802998171815800998171816000a5eb80cc00c00cc0c0008c0b800502c1bae302600133003003302b0023029001409c44b30010018a508acc004cdc79bae30283758605000201f14a3133002002302900140888132294102044cc094008cc0100100062660080080028100c090004c094005022180080425eb80dd6180f800918021980f99ba548008cc07cdd4800a5eb80cc07d30103d87a80004bd70180f800980f001180c1baa005374a9000180b9baa00422323300100100322330030013002002805402a01500a40706eb8c064c058dd50034590131b87480010120c04cc050004c04c004c038dd500a45268a9980624811856616c696461746f722072657475726e65642066616c73650013656402c1"; // Using index 0 for deposit intent spend
    blueprint
        .param_script(
            &compiled_code,
            &[
                &byte_string(oracle_nft).to_string(),
                &byte_string(&lp_token_mint_blueprint.hash).to_string(),
            ],
            BuilderDataType::JSON,
        )
        .unwrap();
    Ok(blueprint)
}

#[cfg(test)]
mod tests {

    use super::*;
    use dotenv::dotenv;

    #[test]
    fn test_withdrawal_intent_mint_blueprint() {
        dotenv().ok();

        let blueprint = withdrawal_intent_mint_blueprint("todo").unwrap();
        assert_eq!(blueprint.hash, "TODO");
        assert_eq!(blueprint.cbor, "TODO");
    }

    #[test]
    fn test_withdrawal_intent_spend_blueprint() {
        dotenv().ok();

        let blueprint = withdrawal_intent_spend_blueprint("todo").unwrap();
        assert_eq!(blueprint.hash, "TODO");
        assert_eq!(blueprint.cbor, "TODO");
    }
}
